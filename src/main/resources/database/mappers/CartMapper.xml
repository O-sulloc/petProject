<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.pj.pet.carts.CartMapper">

 	<select id="cartList" parameterType="UserVO" resultMap="cartResult">
	SELECT C.*,P.PRODUCTNAME,P.PRODUCTPRICE,P.RATE,P.PRODUCTCOUNT
	FROM CARTS C
	LEFT JOIN
	PRODUCTS P
	ON(C.PRODUCTNUM=P.PRODUCTNUM)
	WHERE ID =#{id}
	</select>

	<resultMap type="CartVO" id="cartResult">
		<id column="cartNum" property="cartNum" />
		<result column="id" property="id" />
		<result column="productNum" property="productNum" />
		<result column="productAmount" property="productAmount" />
		<result column="payCheck" property="payCheck" />
		<collection property="productVO" javaType="ProductVO" ofType="ProductVO">
			<id column="productNum" property="productNum" />
			<result column="productPrice" property="productPrice" />
			<result column="productName" property="productName" />
			<result column="productCount" property="productCount" />
			<result column="rate" property="rate" />
		</collection>
	</resultMap> 
	
	<insert id="cartAdd" parameterType="CartVO">
		INSERT INTO CARTS(CARTNUM,ID,PRODUCTNUM,PRODUCTAMOUNT,PAYCHECK)
		VALUES(null,#{id},#{productNum},#{productAmount},0)
	</insert>
		
	<update id="cartUpdate" parameterType="CartVO">
		UPDATE CARTS SET PRODUCTAMOUNT=#{productAmount} WHERE CARTNUM=#{cartNum}
	</update>
	
	<delete id="cartDelete" parameterType="CartVO">
		DELETE FROM CARTS WHERE CARTNUM=#{cartNum}
	</delete>

</mapper>